<div class="page-header">
    <h2>Consumos de Empleados</h2>
    <button id="btn-nuevo-consumo" class="btn btn-primary">+ Nuevo Consumo</button>
</div>

<div class="page-content">
    <!-- Barra de búsqueda y filtros -->
    <div class="search-bar">
        <input type="text" id="search-consumo" placeholder="Buscar por empleado o producto..." class="search-input">
        <select id="filter-estado" class="filter-select">
            <option value="all">Todos los estados</option>
            <option value="pendiente">Pendientes</option>
            <option value="pagado">Pagados</option>
        </select>
        <select id="filter-empleado" class="filter-select">
            <option value="all">Todos los empleados</option>
        </select>
    </div>

    <!-- Tabla de consumos -->
    <div class="table-container">
        <table class="data-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Empleado</th>
                    <th>Producto</th>
                    <th>Cantidad</th>
                    <th>Precio Unit. (Bs)</th>
                    <th>Total (Bs)</th>
                    <th>Fecha</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody id="consumos-table-body">
                <tr>
                    <td colspan="9" class="loading">Cargando consumos...</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="pagination-consumos" class="pagination"></div>
</div>

<!-- Modal para crear/editar consumo -->
<div id="consumo-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-title">Nuevo Consumo</h3>
            <button class="modal-close" id="close-modal">&times;</button>
        </div>
        <form id="consumo-form">
            <input type="hidden" id="consumo-id">
            
            <div class="form-row">
                <div class="form-group">
                    <label for="consumo-empleado">Empleado *</label>
                    <select id="consumo-empleado" name="id_empleado" required>
                        <option value="">Seleccione un empleado...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="consumo-fecha">Fecha *</label>
                    <input type="date" id="consumo-fecha" name="fecha" required>
                </div>
            </div>

            <div class="form-group">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <label style="margin: 0;">Productos *</label>
                    <button type="button" id="btn-agregar-producto" class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px;">+ Agregar Producto</button>
                </div>
                <div id="productos-lista" style="display: flex; flex-direction: column; gap: 15px;">
                    <!-- Los productos se agregarán aquí dinámicamente -->
                </div>
            </div>

            <div class="form-row">
                <div class="form-group" style="flex: 1;">
                    <label for="consumo-total-general">Total General (Bs)</label>
                    <input type="text" id="consumo-total-general" name="total_general" placeholder="0.00" inputmode="decimal" readonly style="font-size: 18px; font-weight: 600;">
                </div>
            </div>

            <div class="info-box">
                <p><strong>Nota:</strong> Puedes agregar múltiples productos. El precio se calcula automáticamente según el precio actual de cada producto en bolívares. Estos consumos se descontarán de la nómina del empleado cuando se genere el pago.</p>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" id="cancel-consumo">Cancelar</button>
                <button type="submit" class="btn btn-primary">Guardar</button>
            </div>
        </form>
    </div>
</div>

<!-- Modal de confirmación para eliminar -->
<div id="delete-modal" class="modal">
    <div class="modal-content modal-small">
        <div class="modal-header">
            <h3>Confirmar Eliminación</h3>
            <button class="modal-close" id="close-delete-modal">&times;</button>
        </div>
        <div class="modal-body">
            <p>¿Estás seguro de que deseas eliminar este consumo?</p>
            <p class="warning-text">Esta acción no se puede deshacer. Si el consumo ya fue pagado en una nómina, no se puede eliminar.</p>
        </div>
        <div class="modal-actions">
            <button type="button" class="btn btn-secondary" id="cancel-delete">Cancelar</button>
            <button type="button" class="btn btn-danger" id="confirm-delete">Eliminar</button>
        </div>
    </div>
</div>

